{% extends "base.html" %}

{% block title %}Adaptive Feedback{% endblock %}

{% block head %}
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
body { font-family: 'Poppins', sans-serif; background: #f8f9fa; color: #333; padding: 30px 20px; }
.container { max-width: 900px; margin: 0 auto; }
.feedback-header { text-align: center; margin-bottom: 30px; }
.feedback-header h1 { font-size: 2.5rem; color: #4361ee; margin-bottom: 10px; }
.feedback-header p { font-size: 1.2rem; color: #555; }
.feedback-message { padding: 20px; border-radius: 15px; margin-bottom: 30px; font-size: 1.2rem; font-weight: 500; }
.feedback-message.success { background: #d4edda; color: #155724; border: 1px solid #28a745; }
.feedback-message.warning { background: #fff3cd; color: #856404; border: 1px solid #ffc107; }
.feedback-message.danger { background: #f8d7da; color: #721c24; border: 1px solid #dc3545; }
.weak-topic-card { background: white; border-radius: 16px; padding: 20px; margin-bottom: 20px; box-shadow: 0 10px 25px -5px rgba(0,0,0,0.1); }
.weak-topic-card h3 { margin-bottom: 10px; }
.resource-list { list-style: none; padding-left: 0; }
.resource-list li { margin-bottom: 8px; }
.resource-list a { color: #4361ee; text-decoration: none; }
.resource-list a:hover { text-decoration: underline; }
</style>
{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2>Adaptive Feedback for "{{ test.topic }} - {{ test.difficulty.title() }} Level"</h2>
    <p>Total Questions: {{ total_questions }} | Your Score: {{ score }}</p>

    {% if passed %}
        <div class="alert alert-success">
            {{ suggestions[0].text }}
        </div>
    {% else %}
        <div class="alert alert-warning">
            Needs Improvement ⚠️ Review the tutorials below:
            <div class="row mt-3">
                {% for s in suggestions %}
                <div class="col-md-6 mb-3">
                    <a href="https://www.youtube.com/watch?v={{ s.video_id }}" target="_blank" style="text-decoration:none;">
                        <div class="card shadow-sm">
                            <img src="https://img.youtube.com/vi/{{ s.video_id }}/hqdefault.jpg" class="card-img-top" alt="{{ s.text }}">
                            <div class="card-body text-center">
                                <h5 class="card-title">{{ s.text }}</h5>
                                <i class="fas fa-play-circle fa-2x text-danger"></i>
                            </div>
                        </div>
                    </a>
                </div>
                {% endfor %}
            </div>
        </div>
    {% endif %}
</div>
{% endblock %}
